<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.api.GoodsApiMapper">

	<!-- 상품목록 조회 -->
	<select id="getGoodsList" parameterType="map" resultType="map">
		SELECT
		    A.GOODS_SEQ, 
		    C.NAME,
		    A.GOODS_NAME, 
		    A.CONTENTS, 
		    TO_CHAR(A.ENTER_DATE, 'YYYY.MM.DD') AS ENTER_DATE,
		    B.IMG_SEQ,
		    B.IMG_NAME,
		    (SELECT COUNT(*) FROM T_GOODS_READ WHERE GOODS_SEQ = A.GOODS_SEQ) AS READ_CNT
		FROM T_GOODS A
		    LEFT JOIN T_GOODS_FILE B ON (A.GOODS_SEQ = B.GOODS_SEQ)
		    INNER JOIN T_MEMBER C ON (A.EMAIL = C.EMAIL)
		ORDER BY A.ENTER_DATE DESC
	</select>
	
</mapper>